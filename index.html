<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NANKOTSU ストレングス・ラボ (Pro)</title>
    <style>
        :root {
            --primary-color: #2c3e50;
            --accent-color: #27ae60; /* Bの色（緑） */
            --sub-color: #e74c3c;    /* Aの色（赤） */
            --bg-color: #f8f9fa;
            --text-color: #333;
        }
        body {
            font-family: "Helvetica Neue", Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        .container {
            background: white;
            width: 95%;
            max-width: 700px;
            padding: 40px;
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
            text-align: center;
            position: relative;
        }
        .coach-header { border-bottom: 2px solid #eee; padding-bottom: 20px; margin-bottom: 20px; }
        .coach-title { font-size: 14px; color: #7f8c8d; font-weight: bold; letter-spacing: 1px; }
        h1 { font-size: 24px; color: var(--primary-color); margin: 10px 0; }

        /* 戻るボタン */
        .btn-back {
            position: absolute;
            top: 20px;
            left: 20px;
            background: none;
            border: none;
            color: #999;
            font-size: 14px;
            cursor: pointer;
            padding: 5px 10px;
            border-radius: 4px;
            transition: all 0.2s;
            display: flex; align-items: center; gap: 5px;
        }
        .btn-back:hover { background-color: #f0f0f0; color: #333; }
        
        /* 質問エリア */
        .question-statement { font-size: 1.2em; font-weight: bold; margin-bottom: 20px; min-height: 3em; }
        .question-type-badge {
            background: #eee; color: #555; padding: 2px 8px; border-radius: 4px;
            font-size: 10px; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 10px; display: inline-block;
        }

        /* 選択肢のデザイン強化 */
        .choices-wrapper { 
            display: flex; 
            justify-content: space-between; 
            margin-bottom: 20px; 
            gap: 10px;
        }
        .choice-box { 
            width: 48%; 
            padding: 15px; 
            border-radius: 8px; 
            background: #f9f9f9; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: flex-start; 
            font-size: 0.9em; 
            font-weight: bold;
            color: var(--primary-color);
            border: 1px solid #eee;
            position: relative;
        }
        /* AとBのバッジ */
        .choice-badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 4px;
            color: white;
            font-size: 12px;
            margin-bottom: 8px;
            font-weight: bold;
        }
        .box-a { border-top: 4px solid var(--sub-color); }
        .badge-a { background-color: var(--sub-color); }
        
        .box-b { border-top: 4px solid var(--accent-color); }
        .badge-b { background-color: var(--accent-color); }

        /* 評価ボタン */
        .scale-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 10px 0 5px 0;
            gap: 5px;
        }
        .scale-btn {
            width: 50px; height: 50px; border-radius: 50%;
            border: 2px solid #ddd; background: white;
            cursor: pointer; transition: all 0.2s;
            display: flex; justify-content: center; align-items: center;
            font-weight: bold; color: #666; font-size: 14px;
        }
        .scale-btn.large { width: 60px; height: 60px; font-size: 18px; }
        
        /* ボタンの色変化 */
        .btn-color-a:hover { border-color: var(--sub-color); color: var(--sub-color); }
        .btn-color-b:hover { border-color: var(--accent-color); color: var(--accent-color); }
        .scale-btn:active { transform: scale(0.95); }

        /* 下部のガイドテキスト */
        .scale-guide {
            display: flex;
            justify-content: space-between;
            font-size: 11px;
            color: #888;
            margin-bottom: 30px;
            padding: 0 10px;
        }

        /* プログレスバー */
        .progress-section { margin-top: 10px; }
        .progress-bar-bg { width: 100%; height: 6px; background: #eee; border-radius: 3px; overflow: hidden; }
        .progress-bar-fill { height: 100%; background: var(--accent-color); width: 0%; transition: width 0.3s; }

        /* 結果画面 */
        .result-card { text-align: left; background: #fff; border: 1px solid #eee; border-left: 6px solid var(--accent-color); padding: 20px; margin-bottom: 15px; border-radius: 8px; }
        .domain-badge { padding: 4px 10px; border-radius: 20px; font-size: 11px; color: white; margin-left: 10px; }
        .domain-Executing { background-color: #8e44ad; }
        .domain-Influencing { background-color: #d35400; }
        .domain-Relationship { background-color: #2980b9; }
        .domain-Strategic { background-color: #27ae60; }

        .btn-start { background: var(--accent-color); color: white; border: none; padding: 15px 40px; font-size: 18px; border-radius: 30px; cursor: pointer; font-weight: bold; margin-top: 20px; }
        .hidden { display: none; }
    </style>
</head>
<body>

<div class="container">
    <button id="btn-back" class="btn-back hidden" onclick="goBack()">
        <span>&#8592;</span> 戻る
    </button>

    <div class="coach-header">
        <div class="coach-title">Strengths Coach AI</div>
        <h1 id="page-title">才能の源泉診断 (Pro)</h1>
    </div>

    <div id="start-screen">
        <div style="text-align: left; background: #eef2f5; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
            <p><strong>【診断のポイント】</strong></p>
            <ul style="padding-left: 20px; color: #555;">
                <li>質問数は増えましたが、その分<strong>精度が劇的に向上</strong>しています。</li>
                <li><strong>「直感」</strong>も測定しています。考え込まず、パッと感じた方を選んでください。</li>
                <li>押し間違えても、左上の「戻る」ボタンで修正できます。</li>
            </ul>
        </div>
        <button class="btn-start" onclick="startQuiz()">診断を開始する</button>
    </div>

    <div id="quiz-screen" class="hidden">
        <span id="q-type" class="question-type-badge">HEAD</span>
        <div id="question-text" class="question-statement">質問文</div>

        <div class="choices-wrapper">
            <div class="choice-box box-a">
                <span class="choice-badge badge-a">A</span>
                <span id="text-a">Aの選択肢</span>
            </div>
            <div class="choice-box box-b">
                <span class="choice-badge badge-b">B</span>
                <span id="text-b">Bの選択肢</span>
            </div>
        </div>

        <div class="scale-container">
            <button class="scale-btn large btn-color-a" onclick="handleAnswer(1)">A</button>
            <button class="scale-btn medium btn-color-a" onclick="handleAnswer(2)">Aやや</button>
            <button class="scale-btn small" onclick="handleAnswer(3)">ー</button>
            <button class="scale-btn medium btn-color-b" onclick="handleAnswer(4)">Bやや</button>
            <button class="scale-btn large btn-color-b" onclick="handleAnswer(5)">B</button>
        </div>

        <div class="scale-guide">
            <span style="color:var(--sub-color)">← Aに強く当てはまる</span>
            <span style="color:var(--accent-color)">Bに強く当てはまる →</span>
        </div>

        <div class="progress-section">
            <div style="display:flex; justify-content:space-between; margin-bottom:5px; font-size:12px; color:#aaa;">
                <span id="progress-text">0 / 0</span>
            </div>
            <div class="progress-bar-bg">
                <div id="progress-bar" class="progress-bar-fill"></div>
            </div>
        </div>
    </div>

    <div id="result-screen" class="hidden">
        <h2>あなたのTop 5資質</h2>
        <div id="result-list"></div>
        <button class="btn-start" onclick="location.reload()" style="background:#95a5a6; margin-top:30px;">トップに戻る</button>
    </div>
</div>

<script>
    // ▼▼▼ JSONデータを貼り付け ▼▼▼
    const diagnosisData = {
      "themes": [
        // --- 1. 実行力 (Executing) ---
        {
          "name_jp": "達成欲",
          "name_en": "Achiever",
          "domain": "Executing",
          "keywords": ["スタミナ", "生産性", "完了", "多忙"],
          "questions": [
            { "type": "head", "text": "何もない休日、あなたの頭の中は？", "options": {"A": "「やった、完全に休める！」と心から思う", "B": "「何か有意義なことをしなきゃ」とソワソワする"} },
            { "type": "heart", "text": "一日の終わりの「最高の気分」はどっち？", "options": {"A": "友達と楽しく過ごせたとき", "B": "やるべきことを全部終わらせたとき"} },
            { "type": "hand", "text": "すでに終わった用事を、わざわざリストに書いて消したことがある？", "options": {"A": "ない（意味がないと思う）", "B": "ある（完了した！って感じがして好き）"} }
          ]
        },
        {
          "name_jp": "アレンジ",
          "name_en": "Arranger",
          "domain": "Executing",
          "keywords": ["構成", "柔軟", "効率", "配置"],
          "questions": [
            { "type": "head", "text": "複雑なパズルみたいな状況、どう思う？", "options": {"A": "決まったやり方で着実に解きたい", "B": "もっと効率的な手順がないか、組み替えて試したい"} },
            { "type": "heart", "text": "急な予定変更やトラブルが起きたとき、どう感じる？", "options": {"A": "「うわ、面倒だな…」とストレス", "B": "「よーし、どう捌いてやろうか」と少しワクワク"} },
            { "type": "hand", "text": "旅行のスケジュール、どう立てる？", "options": {"A": "一度決めた計画通りに進めたい", "B": "その場の状況に合わせて、直前までプランを変える"} }
          ]
        },
        {
          "name_jp": "信念",
          "name_en": "Belief",
          "domain": "Executing",
          "keywords": ["価値観", "倫理", "家族", "犠牲"],
          "questions": [
            { "type": "head", "text": "仕事や活動を選ぶとき、一番大事なのは？", "options": {"A": "給料やメリットなどの条件", "B": "自分の「価値観」に合っているかどうか"} },
            { "type": "heart", "text": "誰かが何かに熱く燃えているのを見たとき、どう思う？", "options": {"A": "「冷静になればいいのに」と思う", "B": "その目的が立派なら、強く心を動かされる"} },
            { "type": "hand", "text": "自分の信条に反する仕事を頼まれたら？", "options": {"A": "仕事だからと割り切ってやる", "B": "どんなにお金をもらえても断る"} }
          ]
        },
        {
          "name_jp": "公平性",
          "name_en": "Consistency",
          "domain": "Executing",
          "keywords": ["平等", "ルール", "バランス", "標準化"],
          "questions": [
            { "type": "head", "text": "チームをまとめるのに大切なのはどっち？", "options": {"A": "一人ひとりの事情に合わせて対応を変えること", "B": "全員に対して、同じルールを公平に適用すること"} },
            { "type": "heart", "text": "「あの人だけ特別扱い」されているのを見たら？", "options": {"A": "「まあ、そういうこともあるか」と流す", "B": "「ズルい、不公平だ」とイライラする"} },
            { "type": "hand", "text": "仕事のやり方を決めるとき、どうする？", "options": {"A": "その時々で臨機応変に変える", "B": "誰がやっても同じ結果になるようマニュアル化する"} }
          ]
        },
        {
          "name_jp": "慎重さ",
          "name_en": "Deliberative",
          "domain": "Executing",
          "keywords": ["リスク", "警戒", "プライバシー", "準備"],
          "questions": [
            { "type": "head", "text": "新しい話を聞いたとき、真っ先に考えるのは？", "options": {"A": "「どんな面白いことがあるかな？」（期待）", "B": "「どこかに落とし穴がないかな？」（警戒）"} },
            { "type": "heart", "text": "初対面の人にプライベートな話をするとき、どう？", "options": {"A": "全然平気、オープンに話せる", "B": "ちょっと抵抗がある、警戒してしまう"} },
            { "type": "hand", "text": "大事な決断をするとき、どう動く？", "options": {"A": "直感を信じてパッと決める", "B": "あらゆるリスクを考えて、入念に下調べする"} }
          ]
        },
        {
          "name_jp": "規律性",
          "name_en": "Discipline",
          "domain": "Executing",
          "keywords": ["構造", "ルーチン", "正確", "秩序"],
          "questions": [
            { "type": "head", "text": "ぐちゃぐちゃでカオスな状況に置かれたら？", "options": {"A": "「なんとかなるさ」と流れに身を任せる", "B": "「まずは整理しなきゃ」と片付けたくなる"} },
            { "type": "heart", "text": "予定通りに物事がピタッと進んだとき、どう感じる？", "options": {"A": "特に何も感じない", "B": "ものすごい安心感と快感を覚える"} },
            { "type": "hand", "text": "締め切りの管理、どうしてる？", "options": {"A": "ギリギリになってから一気にやる", "B": "毎日少しずつ、計画通りに進める"} }
          ]
        },
        {
          "name_jp": "目標志向",
          "name_en": "Focus",
          "domain": "Executing",
          "keywords": ["ゴール", "集中", "優先順位", "軌道修正"],
          "questions": [
            { "type": "head", "text": "会議で話が脱線し始めたら、どう思う？", "options": {"A": "「面白い話だから聞いておこう」", "B": "「目的からズレてる、戻さなきゃ」と気になる"} },
            { "type": "heart", "text": "特に目標もなく、ただダラダラ過ごす時間は？", "options": {"A": "気楽で楽しい", "B": "何をしていいか分からず、なんだか落ち着かない"} },
            { "type": "hand", "text": "作業中に「面白そうな別の件」が飛び込んできたら？", "options": {"A": "興味が移ってそっちを始めちゃう", "B": "今のゴールを達成するまで、それは後回しにする"} }
          ]
        },
        {
          "name_jp": "責任感",
          "name_en": "Responsibility",
          "domain": "Executing",
          "keywords": ["約束", "忠実", "義務", "信頼"],
          "questions": [
            { "type": "head", "text": "引き受けた仕事が終わらなそうなとき、どう考える？", "options": {"A": "「無理なものは無理、仕方ない」と割り切る", "B": "「自分の名前において、絶対にやり遂げなきゃ」と焦る"} },
            { "type": "heart", "text": "小さな約束でも、もし守れなかったとしたら？", "options": {"A": "「ごめん！」と謝って済ませる", "B": "すごい罪悪感を感じて、なんとか埋め合わせしたくなる"} },
            { "type": "hand", "text": "誰も見ていない場所でも、ルールを守る？", "options": {"A": "バレなきゃ手を抜くこともある", "B": "誰が見ていなくても、必ず守る"} }
          ]
        },
        {
          "name_jp": "回復志向",
          "name_en": "Restorative",
          "domain": "Executing",
          "keywords": ["解決", "修復", "問題", "改善"],
          "questions": [
            { "type": "head", "text": "どっちのプロジェクトに惹かれる？", "options": {"A": "順調に進んでいるものを、さらに伸ばす仕事", "B": "トラブルだらけのものを、正常に戻す仕事"} },
            { "type": "heart", "text": "他人のミスや、システムのエラーを見つけたとき？", "options": {"A": "「誰か直すだろう」とスルーする", "B": "「あ、直したい！」とウズウズする"} },
            { "type": "hand", "text": "自分の過去の失敗について、どうする？", "options": {"A": "終わったことだし忘れる", "B": "なぜ失敗したか徹底的に分析する"} }
          ]
        },

        // --- 2. 影響力 (Influencing) ---
        {
          "name_jp": "活発性",
          "name_en": "Activator",
          "domain": "Influencing",
          "keywords": ["行動", "開始", "不耐", "触媒"],
          "questions": [
            { "type": "head", "text": "新しいことを始めるとき、あなたのスタイルは？", "options": {"A": "しっかり情報を集めてから動く", "B": "「まずはやってみよう！」と走りながら考える"} },
            { "type": "heart", "text": "会議で議論だけが続いて、結論が出ないとき？", "options": {"A": "慎重な議論は大事だと思う", "B": "「いつまで喋ってんだ、早く動こうぜ」とイライラする"} },
            { "type": "hand", "text": "新しい家電の説明書、読む？", "options": {"A": "ちゃんと読んでから使う", "B": "とりあえず電源を入れて、いじりながら覚える"} }
          ]
        },
        {
          "name_jp": "指令性",
          "name_en": "Command",
          "domain": "Influencing",
          "keywords": ["主導権", "対立", "明確", "決断"],
          "questions": [
            { "type": "head", "text": "意見の対立が起きたとき、どう思う？", "options": {"A": "「揉めるのは嫌だな、避けたいな」", "B": "「本音をぶつけ合って解決しよう」"} },
            { "type": "heart", "text": "誰も決められなくて、場がシーンとしているとき？", "options": {"A": "誰かが決めるのを待つ", "B": "「じゃあ私が決めるよ」と言いたくてウズウズする"} },
            { "type": "hand", "text": "相手にとって耳の痛いこと、言える？", "options": {"A": "オブラートに包むか、言わずに済ませる", "B": "はっきりと率直に伝えることができる"} }
          ]
        },
        {
          "name_jp": "コミュニケーション",
          "name_en": "Communication",
          "domain": "Influencing",
          "keywords": ["言葉", "話す", "物語", "表現"],
          "questions": [
            { "type": "head", "text": "考えをまとめるとき、どっちがスムーズ？", "options": {"A": "一人でじっくりノートに書く", "B": "誰かにペラペラ話しているうちにまとまる"} },
            { "type": "heart", "text": "大勢の前でプレゼンして！と言われたら？", "options": {"A": "緊張するし、できれば避けたい", "B": "「注目されるぞ！」とワクワクする"} },
            { "type": "hand", "text": "人に何かを伝えるとき、どう話す？", "options": {"A": "事実だけを簡潔に伝える", "B": "面白い例え話やストーリーを使って話す"} }
          ]
        },
        {
          "name_jp": "競争性",
          "name_en": "Competition",
          "domain": "Influencing",
          "keywords": ["勝利", "一番", "比較", "ライバル"],
          "questions": [
            { "type": "head", "text": "「うまくいった！」と判断する基準は？", "options": {"A": "過去の自分より成長できたか", "B": "周りのライバルより良い結果だったか"} },
            { "type": "heart", "text": "ゲームや勝負事で負けたとき、どう感じる？", "options": {"A": "「楽しかったからいいや」と思う", "B": "悔しくてたまらない、次は絶対勝ちたい！"} },
            { "type": "hand", "text": "作業中、無意識にしちゃうのは？", "options": {"A": "自分のペースを守って進める", "B": "隣の人をチラチラ見て、負けないようにスピードを上げる"} }
          ]
        },
        {
          "name_jp": "最上志向",
          "name_en": "Maximizer",
          "domain": "Influencing",
          "keywords": ["優秀", "卓越", "強み", "質"],
          "questions": [
            { "type": "head", "text": "時間を使うなら、どっちに投資したい？", "options": {"A": "苦手なことを克服して、平均レベルにする", "B": "得意なことを伸ばして、天才レベルにする"} },
            { "type": "heart", "text": "「弱点を直そう」と言われたら、どう思う？", "options": {"A": "成長のために必要だと思う", "B": "テンションが下がるし、時間の無駄だと感じる"} },
            { "type": "hand", "text": "何かを作るときの仕上げ、どこで終わる？", "options": {"A": "合格ラインに達したら完了", "B": "納得いくまで、ピカピカになるまで磨き続ける"} }
          ]
        },
        {
          "name_jp": "自己確信",
          "name_en": "Self-Assurance",
          "domain": "Influencing",
          "keywords": ["自信", "羅針盤", "直感", "独立"],
          "questions": [
            { "type": "head", "text": "大事な決断、最後は何を信じる？", "options": {"A": "データや専門家のアドバイス", "B": "「なんとなくこっちだ」という自分の直感"} },
            { "type": "heart", "text": "周り全員が反対している道を進むとき、どう？", "options": {"A": "不安で足が止まってしまう", "B": "「自分は正しい」という謎の自信がある"} },
            { "type": "hand", "text": "リスクのある挑戦をするとき、どう動く？", "options": {"A": "慎重に石橋を叩いて渡る", "B": "「なんとかなるでしょ！」と大胆に飛び込む"} }
          ]
        },
        {
          "name_jp": "自我",
          "name_en": "Significance",
          "domain": "Influencing",
          "keywords": ["重要", "認知", "影響力", "独立"],
          "questions": [
            { "type": "head", "text": "どっちの仕事にやりがいを感じる？", "options": {"A": "誰にも知られないけど、役に立つ仕事", "B": "たくさんの人に認められて、影響を与える仕事"} },
            { "type": "heart", "text": "自分の貢献がスルーされたり、軽く扱われたら？", "options": {"A": "あまり気にしない", "B": "プライドが傷つくし、イラっとする"} },
            { "type": "hand", "text": "役割を選ぶなら、どっち？", "options": {"A": "縁の下の力持ち", "B": "注目を浴びる表舞台の主役"} }
          ]
        },
        {
          "name_jp": "社交性",
          "name_en": "Woo",
          "domain": "Influencing",
          "keywords": ["出会い", "魅力", "人脈", "第一印象"],
          "questions": [
            { "type": "head", "text": "知らない人がいっぱいのパーティ会場に入ったら？", "options": {"A": "「知ってる人いるかな…」と不安になる", "B": "「新しい出会いがありそう！」とワクワクする"} },
            { "type": "heart", "text": "初対面の人と会話するのって、どう？", "options": {"A": "ちょっと気疲れする", "B": "元気をもらえるし、大好き"} },
            { "type": "hand", "text": "交流会での動き方は？", "options": {"A": "少人数の人とじっくり話す", "B": "会場を回って、たくさんの人と挨拶する"} }
          ]
        },

        // --- 3. 人間関係構築力 (Relationship Building) ---
        {
          "name_jp": "適応性",
          "name_en": "Adaptability",
          "domain": "Relationship Building",
          "keywords": ["今", "柔軟", "流れ", "即興"],
          "questions": [
            { "type": "head", "text": "将来の計画について、どう考えてる？", "options": {"A": "数年先までしっかり計画を立てておきたい", "B": "未来なんて分からないし、その時々で考えればいい"} },
            { "type": "heart", "text": "急なトラブルで予定が全部パァになったら？", "options": {"A": "「どうしよう…」とパニックになる", "B": "「じゃあ別のことしよう！」とすぐ切り替える"} },
            { "type": "hand", "text": "仕事の進め方、どっちが得意？", "options": {"A": "毎日決まったことをコツコツやる", "B": "毎日違うことが起きる状況に対応する"} }
          ]
        },
        {
          "name_jp": "運命思考",
          "name_en": "Connectedness",
          "domain": "Relationship Building",
          "keywords": ["つながり", "縁", "全体像", "スピリチュアル"],
          "questions": [
            { "type": "head", "text": "世の中で起きる出来事はどうだと思う？", "options": {"A": "ただの偶然の積み重ねだ", "B": "すべては何らかの意味があって繋がっている"} },
            { "type": "heart", "text": "「不思議なご縁」を感じたとき、どう思う？", "options": {"A": "「たまたまでしょ」と思う", "B": "深い安心感や、運命的なものを感じる"} },
            { "type": "hand", "text": "誰かを助けるとき、どう考えてる？", "options": {"A": "ただの親切心でやっている", "B": "巡り巡って、いつか自分に返ってくると思っている"} }
          ]
        },
        {
          "name_jp": "成長促進",
          "name_en": "Developer",
          "domain": "Relationship Building",
          "keywords": ["育成", "可能性", "進歩", "忍耐"],
          "questions": [
            { "type": "head", "text": "他人を見るとき、どこに目が行く？", "options": {"A": "今の実力や成績", "B": "その人の「伸びしろ」や将来性"} },
            { "type": "heart", "text": "誰かが小さな進歩（初めて何かができた時など）を見せたら？", "options": {"A": "「まだ未熟だな」と冷静に見る", "B": "自分のことのように嬉しくて感動する"} },
            { "type": "hand", "text": "後輩への教え方、どっちに近い？", "options": {"A": "手っ取り早く答えを教える", "B": "時間がかかっても、自分で気づくまで待つ"} }
          ]
        },
        {
          "name_jp": "共感性",
          "name_en": "Empathy",
          "domain": "Relationship Building",
          "keywords": ["感情", "直感", "雰囲気", "理解"],
          "questions": [
            { "type": "head", "text": "悩んでいる人を理解しようとするとき？", "options": {"A": "事実関係を整理して論理的に考える", "B": "相手の気持ちになりきって、感情を感じる"} },
            { "type": "heart", "text": "近くに泣いている人がいたら？", "options": {"A": "「何かあったのかな」と客観的に見る", "B": "自分まで悲しくなって、胸がキュッとなる"} },
            { "type": "hand", "text": "相談を受けたとき、ついしちゃうのは？", "options": {"A": "「こうすればいいよ」と解決策を出す", "B": "「辛かったね、わかるよ」と気持ちに寄り添う"} }
          ]
        },
        {
          "name_jp": "調和性",
          "name_en": "Harmony",
          "domain": "Relationship Building",
          "keywords": ["合意", "平和", "同意", "対立回避"],
          "questions": [
            { "type": "head", "text": "会議で一番大事なゴールは？", "options": {"A": "徹底的に議論して、ベストな案を出すこと", "B": "みんなが納得できる合意点を見つけること"} },
            { "type": "heart", "text": "誰かが怒鳴り合って議論していたら？", "options": {"A": "「活気があっていいな」と思う", "B": "胃が痛くなるから、すぐに止めてほしい"} },
            { "type": "hand", "text": "意見が対立したとき、どう動く？", "options": {"A": "自分の正しさを主張して戦う", "B": "お互いの妥協点を探して、場を収める"} }
          ]
        },
        {
          "name_jp": "包含",
          "name_en": "Includer",
          "domain": "Relationship Building",
          "keywords": ["仲間外れ", "包容", "多様性", "参加"],
          "questions": [
            { "type": "head", "text": "チームを作るとき、どっちがいい？", "options": {"A": "選ばれた優秀なメンバーだけで固める", "B": "できるだけ多くの人に参加チャンスをあげる"} },
            { "type": "heart", "text": "輪に入れずポツンとしている人を見たら？", "options": {"A": "「一人が好きなのかな」と思って放っておく", "B": "気になって仕方なくて、声をかけたくなる"} },
            { "type": "hand", "text": "人が増えすぎて席が足りない！どうする？", "options": {"A": "入れない人は断るしかない", "B": "「詰めればなんとかなる！」と全員入れようとする"} }
          ]
        },
        {
          "name_jp": "個別化",
          "name_en": "Individualization",
          "domain": "Relationship Building",
          "keywords": ["ユニーク", "カスタマイズ", "違い", "配置"],
          "questions": [
            { "type": "head", "text": "人を評価するとき、どこを見る？", "options": {"A": "みんなと同じようにできているか（共通点）", "B": "その人だけのユニークな特徴（違い）"} },
            { "type": "heart", "text": "「あなたたち若者は〜」と一括りにされたら？", "options": {"A": "まあ、そんなもんだと思う", "B": "「ひとくくりにするな！」とイラッとする"} },
            { "type": "hand", "text": "プレゼント選び、どうする？", "options": {"A": "誰にでも喜ばれる定番のギフト券などにする", "B": "その人の好みに合わせて、一人ひとり違うものを選ぶ"} }
          ]
        },
        {
          "name_jp": "ポジティブ",
          "name_en": "Positivity",
          "domain": "Relationship Building",
          "keywords": ["楽観", "情熱", "称賛", "ユーモア"],
          "questions": [
            { "type": "head", "text": "ピンチに陥ったとき、どう考える？", "options": {"A": "最悪のケースを想定して備える", "B": "「まあ、なんとかなるっしょ！」と良い面を探す"} },
            { "type": "heart", "text": "お葬式みたいに暗い雰囲気の会議室、どう感じる？", "options": {"A": "真剣な場だから仕方ない", "B": "息が詰まりそうで、冗談でも言って笑わせたい"} },
            { "type": "hand", "text": "人をやる気にさせるとき、どうする？", "options": {"A": "ダメなところを指摘して修正させる", "B": "良いところを褒めちぎって乗せる"} }
          ]
        },
        {
          "name_jp": "親密性",
          "name_en": "Relator",
          "domain": "Relationship Building",
          "keywords": ["信頼", "深い", "友人", "透明性"],
          "questions": [
            { "type": "head", "text": "理想的な人間関係はどっち？", "options": {"A": "広く浅く、知り合いがたくさんいること", "B": "少人数でも、何でも話せる「親友」がいること"} },
            { "type": "heart", "text": "まだよく知らない人にプライベートを聞かれたら？", "options": {"A": "特に気にならない", "B": "「なんで教えなきゃいけないの？」と壁を作る"} },
            { "type": "hand", "text": "忙しいとき、どっちに行く？", "options": {"A": "名刺交換ができる異業種交流会", "B": "いつものメンバーと行く居酒屋"} }
          ]
        },

        // --- 4. 戦略的思考力 (Strategic Thinking) ---
        {
          "name_jp": "分析思考",
          "name_en": "Analytical",
          "domain": "Strategic Thinking",
          "keywords": ["データ", "証明", "論理", "客観"],
          "questions": [
            { "type": "head", "text": "誰かの意見を聞いたとき、まず考えるのは？", "options": {"A": "「その気持ち、わかるなあ」（共感）", "B": "「それ、証拠はあるの？」（事実確認）"} },
            { "type": "heart", "text": "データや数字で理路整然と説明されたら？", "options": {"A": "なんか冷たい感じがして苦手", "B": "スッキリしてて気持ちいい、美しいと感じる"} },
            { "type": "hand", "text": "何かを主張するとき、どうする？", "options": {"A": "情熱やストーリーで訴えかける", "B": "グラフやデータを提示して証明する"} }
          ]
        },
        {
          "name_jp": "原点思考",
          "name_en": "Context",
          "domain": "Strategic Thinking",
          "keywords": ["過去", "歴史", "背景", "経緯"],
          "questions": [
            { "type": "head", "text": "未来の計画を立てるのに必要なのは？", "options": {"A": "まだ見ぬ新しいビジョン", "B": "過去の成功例や、これまでの経緯"} },
            { "type": "heart", "text": "歴史の話や昔話を聞くの、好き？", "options": {"A": "古臭くて退屈だ", "B": "学びがあるし、面白いと思う"} },
            { "type": "hand", "text": "新しい環境に入ったら、まず何をする？", "options": {"A": "これからの目標を立てる", "B": "それがどうやって出来たのか、背景や歴史を調べる"} }
          ]
        },
        {
          "name_jp": "未来志向",
          "name_en": "Futuristic",
          "domain": "Strategic Thinking",
          "keywords": ["ビジョン", "夢", "明日", "可能性"],
          "questions": [
            { "type": "head", "text": "普段、あなたの思考はどこにある？", "options": {"A": "「今、目の前のこと」や「過去」", "B": "「10年後、20年後の未来」"} },
            { "type": "heart", "text": "「もし〜だったら」という未来の話をしてるとき？", "options": {"A": "「現実見ようよ」と冷める", "B": "エネルギーが湧いてきてワクワクする"} },
            { "type": "hand", "text": "壁にぶつかったとき、どうやって乗り越える？", "options": {"A": "足元の問題を一つずつ片付ける", "B": "成功した未来の姿を具体的にイメージして頑張る"} }
          ]
        },
        {
          "name_jp": "着想",
          "name_en": "Ideation",
          "domain": "Strategic Thinking",
          "keywords": ["アイデア", "創造", "つながり", "新規性"],
          "questions": [
            { "type": "head", "text": "問題解決の方法、どっちが好き？", "options": {"A": "みんながやってる確実な方法", "B": "今まで誰もやらなかった、斬新な方法"} },
            { "type": "heart", "text": "アイデア出しの会議（ブレスト）は？", "options": {"A": "疲れるし、早く結論を出したい", "B": "最高に楽しい、いくらでも出せる"} },
            { "type": "hand", "text": "一見関係ないもの同士の「つながり」を見つけることは？", "options": {"A": "あまりない", "B": "よくあるし、それを面白がる"} }
          ]
        },
        {
          "name_jp": "収集心",
          "name_en": "Input",
          "domain": "Strategic Thinking",
          "keywords": ["情報", "収集", "知的好奇心", "アーカイブ"],
          "questions": [
            { "type": "head", "text": "知らない言葉に出会ったら？", "options": {"A": "関係なければスルーする", "B": "気になって反射的にググる"} },
            { "type": "heart", "text": "ネットサーフィンしてるとき、どう感じる？", "options": {"A": "早く必要な情報を見つけて終わりたい", "B": "次々と新しい知識が増えるのが快感"} },
            { "type": "hand", "text": "本や資料、どうしてる？", "options": {"A": "読んだら捨てるか、整理して減らす", "B": "「いつか役に立つかも」と思って溜め込む"} }
          ]
        },
        {
          "name_jp": "内省",
          "name_en": "Intellection",
          "domain": "Strategic Thinking",
          "keywords": ["思考", "哲学", "独り", "深さ"],
          "questions": [
            { "type": "head", "text": "「考えること」って、あなたにとって何？", "options": {"A": "行動するための準備運動", "B": "それ自体が目的であり、遊び"} },
            { "type": "heart", "text": "一人でボーッと考え事をする時間が取れないと？", "options": {"A": "寂しいから誰かといたい", "B": "精神的に消耗してイライラする"} },
            { "type": "hand", "text": "「愛とは何か？」みたいな深い議論になったら？", "options": {"A": "「答え出ないしやめよう」と避ける", "B": "「面白い！」と喜んで参加する"} }
          ]
        },
        {
          "name_jp": "学習欲",
          "name_en": "Learner",
          "domain": "Strategic Thinking",
          "keywords": ["学ぶ", "プロセス", "向上", "好奇心"],
          "questions": [
            { "type": "head", "text": "新しいことを始めるとき、何が楽しい？", "options": {"A": "結果が出て褒められること", "B": "できなかったことが、できるようになっていく過程"} },
            { "type": "heart", "text": "全く知らない分野の話を聞くのは？", "options": {"A": "興味がないから退屈", "B": "好奇心が刺激されてワクワクする"} },
            { "type": "hand", "text": "今のスキルで十分仕事ができるとしたら？", "options": {"A": "今のままでいい、楽したい", "B": "それでも何か新しいことを学び続けたい"} }
          ]
        },
        {
          "name_jp": "戦略性",
          "name_en": "Strategic",
          "domain": "Strategic Thinking",
          "keywords": ["選択肢", "パターン", "直感", "予測"],
          "questions": [
            { "type": "head", "text": "複雑な迷路みたいな状況、どう考える？", "options": {"A": "一つずつ順番に道を確認する", "B": "空から見るように全体を把握して、ゴールへの道を描く"} },
            { "type": "heart", "text": "「プランB（もしもの時の案）」を考えるのは？", "options": {"A": "面倒だし、失敗するみたいで嫌だ", "B": "あらゆる可能性を想定できて安心する"} },
            { "type": "hand", "text": "行き詰まったとき、どうする？", "options": {"A": "諦めずに同じ方法で粘る", "B": "「じゃあこっちだ」と即座に別のルートを試す"} }
          ]
        }
      ]
    };
    // ▲▲▲ データここまで ▲▲▲

    let allQuestions = [];
    let currentQuestionIndex = 0;
    let scores = {}; 
    let startTime;
    let historyStack = [];

    const startScreen = document.getElementById('start-screen');
    const quizScreen = document.getElementById('quiz-screen');
    const resultScreen = document.getElementById('result-screen');
    const btnBack = document.getElementById('btn-back');
    
    function prepareQuestions() {
        allQuestions = [];
        scores = {};
        historyStack = [];
        
        diagnosisData.themes.forEach(theme => {
            scores[theme.name_jp] = 0;
            if(theme.questions && Array.isArray(theme.questions)) {
                theme.questions.forEach(q => {
                    allQuestions.push({
                        theme: theme.name_jp,
                        name_en: theme.name_en,
                        domain: theme.domain,
                        keywords: theme.keywords,
                        type: q.type,
                        text: q.text,
                        options: q.options
                    });
                });
            }
        });
        shuffle(allQuestions);
    }

    function shuffle(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
    }

    function startQuiz() {
        if (!diagnosisData.themes || diagnosisData.themes.length === 0) {
            alert("データがありません。JSONデータをコード内に貼り付けてください。");
            return;
        }

        prepareQuestions();
        currentQuestionIndex = 0;
        startScreen.classList.add('hidden');
        quizScreen.classList.remove('hidden');
        renderQuestion();
    }

    function renderQuestion() {
        if (currentQuestionIndex >= allQuestions.length) {
            showResult();
            return;
        }

        const q = allQuestions[currentQuestionIndex];
        
        if (currentQuestionIndex > 0) {
            btnBack.classList.remove('hidden');
        } else {
            btnBack.classList.add('hidden');
        }

        document.getElementById('q-type').textContent = q.type.toUpperCase();
        document.getElementById('question-text').textContent = q.text;
        document.getElementById('text-a').textContent = q.options.A;
        document.getElementById('text-b').textContent = q.options.B;

        const progress = ((currentQuestionIndex) / allQuestions.length) * 100;
        document.getElementById('progress-bar').style.width = `${progress}%`;
        document.getElementById('progress-text').textContent = `${currentQuestionIndex + 1} / ${allQuestions.length}`;
        
        startTime = Date.now();
        window.scrollTo(0, 0);
    }

    function handleAnswer(scaleValue) {
        const endTime = Date.now();
        const responseTime = endTime - startTime;
        const q = allQuestions[currentQuestionIndex];

        let points = 0;
        switch(scaleValue) {
            case 1: points = 0; break;
            case 2: points = 1; break;
            case 3: points = 2; break;
            case 4: points = 3; break;
            case 5: points = 4; break;
        }

        if ((scaleValue === 4 || scaleValue === 5) && responseTime < 2500) {
            points += 0.5;
        }

        scores[q.theme] += points;

        historyStack.push({
            theme: q.theme,
            points: points
        });
        
        currentQuestionIndex++;
        setTimeout(renderQuestion, 150);
    }

    function goBack() {
        if (currentQuestionIndex === 0 || historyStack.length === 0) return;

        currentQuestionIndex--;
        const lastAction = historyStack.pop();

        if (lastAction) {
            scores[lastAction.theme] -= lastAction.points;
        }

        renderQuestion();
    }

    function showResult() {
        quizScreen.classList.add('hidden');
        resultScreen.classList.remove('hidden');
        btnBack.classList.add('hidden');

        const sortedScores = Object.entries(scores).sort((a, b) => b[1] - a[1]);
        const top5 = sortedScores.slice(0, 5);
        const resultList = document.getElementById('result-list');
        resultList.innerHTML = '';

        top5.forEach((item, index) => {
            const themeName = item[0];
            const themeInfo = diagnosisData.themes.find(t => t.name_jp === themeName);
            
            let domainClass = "";
            if(themeInfo.domain.includes("Executing")) domainClass = "domain-Executing";
            else if(themeInfo.domain.includes("Influencing")) domainClass = "domain-Influencing";
            else if(themeInfo.domain.includes("Relationship")) domainClass = "domain-Relationship";
            else if(themeInfo.domain.includes("Strategic")) domainClass = "domain-Strategic";

            const div = document.createElement('div');
            div.className = 'result-card';
            div.innerHTML = `
                <div style="display:flex; justify-content:space-between; align-items:center;">
                    <span style="font-weight:bold; color:#888;">RANK ${index + 1}</span>
                    <span class="domain-badge ${domainClass}">${themeInfo.domain}</span>
                </div>
                <h3>${themeName} <small>(${themeInfo.name_en})</small></h3>
                <p>特徴: ${themeInfo.keywords.join(' / ')}</p>
            `;
            resultList.appendChild(div);
        });
    }
</script>

</body>
</html>