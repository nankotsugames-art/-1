<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NANKOTSU ストレングス・ラボ (Pro)</title>
    <style>
        :root {
            --primary-color: #2c3e50;
            --accent-color: #27ae60; /* Bの色（緑） */
            --sub-color: #e74c3c;    /* Aの色（赤） */
            --bg-color: #f8f9fa;
            --text-color: #333;
        }
        body {
            font-family: "Helvetica Neue", Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        .container {
            background: white;
            width: 95%;
            max-width: 700px;
            padding: 40px;
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
            text-align: center;
            position: relative;
        }
        .coach-header { border-bottom: 2px solid #eee; padding-bottom: 20px; margin-bottom: 20px; }
        .coach-title { font-size: 14px; color: #7f8c8d; font-weight: bold; letter-spacing: 1px; }
        h1 { font-size: 24px; color: var(--primary-color); margin: 10px 0; }

        /* 戻るボタン */
        .btn-back {
            position: absolute;
            top: 20px;
            left: 20px;
            background: none;
            border: none;
            color: #999;
            font-size: 14px;
            cursor: pointer;
            padding: 5px 10px;
            border-radius: 4px;
            transition: all 0.2s;
            display: flex; align-items: center; gap: 5px;
        }
        .btn-back:hover { background-color: #f0f0f0; color: #333; }
        
        /* 質問エリア */
        .question-statement { font-size: 1.2em; font-weight: bold; margin-bottom: 20px; min-height: 3em; }
        .question-type-badge {
            background: #eee; color: #555; padding: 2px 8px; border-radius: 4px;
            font-size: 10px; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 10px; display: inline-block;
        }

        /* 選択肢のデザイン強化 */
        .choices-wrapper { 
            display: flex; 
            justify-content: space-between; 
            margin-bottom: 20px; 
            gap: 10px;
        }
        .choice-box { 
            width: 48%; 
            padding: 15px; 
            border-radius: 8px; 
            background: #f9f9f9; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: flex-start; 
            font-size: 0.9em; 
            font-weight: bold;
            color: var(--primary-color);
            border: 1px solid #eee;
            position: relative;
        }
        /* AとBのバッジ */
        .choice-badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 4px;
            color: white;
            font-size: 12px;
            margin-bottom: 8px;
            font-weight: bold;
        }
        .box-a { border-top: 4px solid var(--sub-color); }
        .badge-a { background-color: var(--sub-color); }
        
        .box-b { border-top: 4px solid var(--accent-color); }
        .badge-b { background-color: var(--accent-color); }

        /* 評価ボタン */
        .scale-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 10px 0 5px 0;
            gap: 5px;
        }
        .scale-btn {
            width: 50px; height: 50px; border-radius: 50%;
            border: 2px solid #ddd; background: white;
            cursor: pointer; transition: all 0.2s;
            display: flex; justify-content: center; align-items: center;
            font-weight: bold; color: #666; font-size: 14px;
        }
        .scale-btn.large { width: 60px; height: 60px; font-size: 18px; }
        
        /* ボタンの色変化 */
        .btn-color-a:hover { border-color: var(--sub-color); color: var(--sub-color); }
        .btn-color-b:hover { border-color: var(--accent-color); color: var(--accent-color); }
        .scale-btn:active { transform: scale(0.95); }

        /* 下部のガイドテキスト */
        .scale-guide {
            display: flex;
            justify-content: space-between;
            font-size: 11px;
            color: #888;
            margin-bottom: 30px;
            padding: 0 10px;
        }

        /* プログレスバー */
        .progress-section { margin-top: 10px; }
        .progress-bar-bg { width: 100%; height: 6px; background: #eee; border-radius: 3px; overflow: hidden; }
        .progress-bar-fill { height: 100%; background: var(--accent-color); width: 0%; transition: width 0.3s; }

        /* 結果画面 */
        .result-card { text-align: left; background: #fff; border: 1px solid #eee; border-left: 6px solid var(--accent-color); padding: 20px; margin-bottom: 15px; border-radius: 8px; }
        .domain-badge { padding: 4px 10px; border-radius: 20px; font-size: 11px; color: white; margin-left: 10px; }
        .domain-Executing { background-color: #8e44ad; }
        .domain-Influencing { background-color: #d35400; }
        .domain-Relationship { background-color: #2980b9; }
        .domain-Strategic { background-color: #27ae60; }

        .btn-start { background: var(--accent-color); color: white; border: none; padding: 15px 40px; font-size: 18px; border-radius: 30px; cursor: pointer; font-weight: bold; margin-top: 20px; }
        .hidden { display: none; }
    </style>
</head>
<body>

<div class="container">
    <button id="btn-back" class="btn-back hidden" onclick="goBack()">
        <span>&#8592;</span> 戻る
    </button>

    <div class="coach-header">
        <div class="coach-title">Strengths Coach AI</div>
        <h1 id="page-title">才能の源泉診断 (Pro)</h1>
    </div>

    <div id="start-screen">
        <div style="text-align: left; background: #eef2f5; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
            <p><strong>【診断のポイント】</strong></p>
            <ul style="padding-left: 20px; color: #555;">
                <li>質問数は多いですが、その分<strong>精度が劇的に向上</strong>しています。</li>
                <li><strong>「直感」</strong>も測定しています。考え込まず、パッと感じた方を選んでください。</li>
                <li>押し間違えても、左上の「戻る」ボタンで修正できます。</li>
            </ul>
        </div>
        <button class="btn-start" onclick="startQuiz()">診断を開始する</button>
    </div>

    <div id="quiz-screen" class="hidden">
        <span id="q-type" class="question-type-badge">HEAD</span>
        <div id="question-text" class="question-statement">質問文</div>

        <div class="choices-wrapper">
            <div class="choice-box box-a">
                <span class="choice-badge badge-a">A</span>
                <span id="text-a">Aの選択肢</span>
            </div>
            <div class="choice-box box-b">
                <span class="choice-badge badge-b">B</span>
                <span id="text-b">Bの選択肢</span>
            </div>
        </div>

        <div class="scale-container">
            <button class="scale-btn large btn-color-a" onclick="handleAnswer(1)">A</button>
            <button class="scale-btn medium btn-color-a" onclick="handleAnswer(2)">Aやや</button>
            <button class="scale-btn small" onclick="handleAnswer(3)">ー</button>
            <button class="scale-btn medium btn-color-b" onclick="handleAnswer(4)">Bやや</button>
            <button class="scale-btn large btn-color-b" onclick="handleAnswer(5)">B</button>
        </div>

        <div class="scale-guide">
            <span style="color:var(--sub-color)">← Aに強く当てはまる</span>
            <span style="color:var(--accent-color)">Bに強く当てはまる →</span>
        </div>

        <div class="progress-section">
            <div style="display:flex; justify-content:space-between; margin-bottom:5px; font-size:12px; color:#aaa;">
                <span id="progress-text">0 / 0</span>
            </div>
            <div class="progress-bar-bg">
                <div id="progress-bar" class="progress-bar-fill"></div>
            </div>
        </div>
    </div>

    <div id="result-screen" class="hidden">
        <h2>あなたのTop 5資質</h2>
        <div id="result-list"></div>
        <button class="btn-start" onclick="location.reload()" style="background:#95a5a6; margin-top:30px;">トップに戻る</button>
    </div>
</div>

<script>
    // ▼▼▼ JSONデータ (34資質×3問 = 102問 完全版) ▼▼▼
    const diagnosisData = {
      "themes": [
        // --- 1. 実行力 (Executing) ---
        {
          "name_jp": "達成欲",
          "name_en": "Achiever",
          "domain": "Executing",
          "keywords": ["スタミナ", "生産性", "完了", "多忙"],
          "questions": [
            { "type": "head", "text": "休日に予定が何もない時、無意識にどう考えますか？", "options": {"A": "「リフレッシュできて最高だ」と心から思う", "B": "「何か生産的なことをしなきゃ」と少し焦る"} },
            { "type": "heart", "text": "一日の終わりに「最高の気分」になるのはどちらの瞬間ですか？", "options": {"A": "プロセスそのものを楽しめた時", "B": "ToDoリストをすべて消し込めた時"} },
            { "type": "hand", "text": "すでに終わったタスクを、後からToDoリストに書き足して線を引いたことがありますか？", "options": {"A": "ない（意味がないと思う）", "B": "ある（完了した実感に快感を覚える）"} }
          ]
        },
        {
          "name_jp": "アレンジ",
          "name_en": "Arranger",
          "domain": "Executing",
          "keywords": ["構成", "柔軟", "効率", "配置"],
          "questions": [
            { "type": "head", "text": "複雑な状況に直面した時、あなたの思考パターンはどちらに近いですか？", "options": {"A": "決められた手順通りに着実に進めようとする", "B": "もっと効率的な手順がないか、パズルを組み替えるように考える"} },
            { "type": "heart", "text": "急な予定変更やトラブルが発生した時、どう感じますか？", "options": {"A": "ストレスを感じる", "B": "「腕の見せ所だ」と少しワクワクする"} },
            { "type": "hand", "text": "旅行やイベントのスケジュールを立てる時、どう行動しますか？", "options": {"A": "一度決めた計画はあまり変えない", "B": "直前まで最適な組み合わせを模索して変更する"} }
          ]
        },
        {
          "name_jp": "信念",
          "name_en": "Belief",
          "domain": "Executing",
          "keywords": ["価値観", "倫理", "家族", "犠牲"],
          "questions": [
            { "type": "head", "text": "仕事や活動を選ぶ際の判断基準として、どちらを重視しますか？", "options": {"A": "条件やメリット・デメリット", "B": "自分の価値観に合っているかどうか"} },
            { "type": "heart", "text": "他人が何かに情熱を燃やしているのを見た時、どう感じますか？", "options": {"A": "客観的に分析する", "B": "その目的が高尚であれば、強く心を動かされる"} },
            { "type": "hand", "text": "自分の信条と対立する仕事を依頼された時、どうしますか？", "options": {"A": "仕事と割り切って引き受ける", "B": "どんなに報酬が良くても断る"} }
          ]
        },
        {
          "name_jp": "公平性",
          "name_en": "Consistency",
          "domain": "Executing",
          "keywords": ["平等", "ルール", "バランス", "標準化"],
          "questions": [
            { "type": "head", "text": "集団を運営する上で、最も大切だと思うのはどちらですか？", "options": {"A": "個々の事情に合わせて柔軟に対応すること", "B": "全員に同じルールを一貫して適用すること"} },
            { "type": "heart", "text": "特定の人が「特別扱い」されているのを見た時、どう感じますか？", "options": {"A": "「そういうこともある」と流す", "B": "不公平だと強くイライラする"} },
            { "type": "hand", "text": "仕事の手順を決める時、どのような行動をとりますか？", "options": {"A": "その場の状況で臨機応変に変える", "B": "誰がやっても同じ結果になるようマニュアル化する"} }
          ]
        },
        {
          "name_jp": "慎重さ",
          "name_en": "Deliberative",
          "domain": "Executing",
          "keywords": ["リスク", "警戒", "プライバシー", "準備"],
          "questions": [
            { "type": "head", "text": "新しい提案を聞いた時、真っ先に考えることは何ですか？", "options": {"A": "「どんな良いことがあるか（可能性）」", "B": "「どこに落とし穴があるか（リスク）」"} },
            { "type": "heart", "text": "プライベートなことを初対面の人に話す時、どう感じますか？", "options": {"A": "オープンに話すのは平気だ", "B": "不用意に話すことには抵抗がある"} },
            { "type": "hand", "text": "重要な決定をする前の行動として、どちらが近いですか？", "options": {"A": "直感を信じて早めに決める", "B": "あらゆるリスクを想定し、入念に裏取りをする"} }
          ]
        },
        {
          "name_jp": "規律性",
          "name_en": "Discipline",
          "domain": "Executing",
          "keywords": ["構造", "ルーチン", "正確", "秩序"],
          "questions": [
            { "type": "head", "text": "カオスな（無秩序な）状況に置かれた時、どう考えますか？", "options": {"A": "「なんとかなる」と流れに身を任せる", "B": "「まずは構造を作らなければ」と整理を始める"} },
            { "type": "heart", "text": "予定通りに物事が進んだ時、どう感じますか？", "options": {"A": "特に何も感じない（予定は未定だから）", "B": "深い安心感と満足感を覚える"} },
            { "type": "hand", "text": "締め切りやスケジュールの管理について、どちらが近いですか？", "options": {"A": "ギリギリになってから追い込む", "B": "あらかじめ細かく区切って計画的に進める"} }
          ]
        },
        {
          "name_jp": "目標志向",
          "name_en": "Focus",
          "domain": "Executing",
          "keywords": ["ゴール", "集中", "優先順位", "軌道修正"],
          "questions": [
            { "type": "head", "text": "会議や会話が脱線し始めた時、どう考えますか？", "options": {"A": "「面白い話だから聞こう」と思う", "B": "「目的からズレている」と気になって仕方がない"} },
            { "type": "heart", "text": "目標を持たずにただ過ごす時間について、どう感じますか？", "options": {"A": "気楽で楽しい", "B": "何をしていいか分からず、落ち着かない"} },
            { "type": "hand", "text": "作業中に別の面白そうな件が飛び込んできた時、どうしますか？", "options": {"A": "興味が移ってそちらを始める", "B": "今のゴールを達成するまで後回しにする"} }
          ]
        },
        {
          "name_jp": "責任感",
          "name_en": "Responsibility",
          "domain": "Executing",
          "keywords": ["約束", "忠実", "義務", "信頼"],
          "questions": [
            { "type": "head", "text": "自分が引き受けた仕事が終わらないかも知れない時、どう考えますか？", "options": {"A": "「無理なものは無理だ」と割り切る", "B": "「自分の名前において、絶対にやり遂げる」と考える"} },
            { "type": "heart", "text": "小さな約束でも、もし守れなかったとしたらどう感じますか？", "options": {"A": "「忘れてた、ごめん」で済ませる", "B": "強い罪悪感と、埋め合わせをしたい衝動に駆られる"} },
            { "type": "hand", "text": "誰も見ていない場所でも、決まり事や約束を守りますか？", "options": {"A": "状況によっては手を抜く", "B": "誰が見ていなくても、必ず守る"} }
          ]
        },
        {
          "name_jp": "回復志向",
          "name_en": "Restorative",
          "domain": "Executing",
          "keywords": ["解決", "修復", "問題", "改善"],
          "questions": [
            { "type": "head", "text": "順調に進んでいるプロジェクトと、問題だらけのプロジェクト。どちらに惹かれますか？", "options": {"A": "順調なプロジェクト（成功を伸ばしたい）", "B": "問題だらけのプロジェクト（立て直したい）"} },
            { "type": "heart", "text": "他人の弱点やシステムのエラーを見つけた時、どう感じますか？", "options": {"A": "見て見ぬふりをする", "B": "「直したい」という衝動を感じる"} },
            { "type": "hand", "text": "自分自身の過去の失敗について、どう行動しますか？", "options": {"A": "過ぎたこととして忘れる", "B": "なぜ失敗したか分析し、再発防止策を練る"} }
          ]
        },
        // --- 2. 影響力 (Influencing) ---
        {
          "name_jp": "活発性",
          "name_en": "Activator",
          "domain": "Influencing",
          "keywords": ["行動", "開始", "不耐", "触媒"],
          "questions": [
            { "type": "head", "text": "新しいプロジェクトを始める時、あなたの思考は？", "options": {"A": "「十分な情報を集めてから動こう」", "B": "「まずはやってみて、走りながら考えよう」"} },
            { "type": "heart", "text": "会議で議論だけが続いて結論が出ない時、どう感じますか？", "options": {"A": "慎重な議論は必要だと感じる", "B": "「いつまで喋っているんだ」とイライラする"} },
            { "type": "hand", "text": "説明書やマニュアルがある時、どうしますか？", "options": {"A": "しっかり読んでから操作する", "B": "とりあえず電源を入れていじりながら覚える"} }
          ]
        },
        {
          "name_jp": "指令性",
          "name_en": "Command",
          "domain": "Influencing",
          "keywords": ["主導権", "対立", "明確", "決断"],
          "questions": [
            { "type": "head", "text": "意見の対立が起きた時、どう考えますか？", "options": {"A": "「対立は避けるべき悪いことだ」", "B": "「対立は真実を明らかにするためのステップだ」"} },
            { "type": "heart", "text": "誰も決断を下せず、場が停滞している時、どう感じますか？", "options": {"A": "誰かが決めるのを待つ", "B": "自分が主導権を握りたくてうずうずする"} },
            { "type": "hand", "text": "相手にとって耳の痛い真実を伝える必要がある時、どうしますか？", "options": {"A": "オブラートに包むか、言わずに済ませる", "B": "はっきりと率直に伝える"} }
          ]
        },
        {
          "name_jp": "コミュニケーション",
          "name_en": "Communication",
          "domain": "Influencing",
          "keywords": ["言葉", "話す", "物語", "表現"],
          "questions": [
            { "type": "head", "text": "自分の考えをまとめる時、どちらがスムーズですか？", "options": {"A": "一人でじっくり書き出す", "B": "誰かに話しながら整理する"} },
            { "type": "heart", "text": "大勢の前でプレゼンをする機会があったら、どう感じますか？", "options": {"A": "緊張するし、できれば避けたい", "B": "注目を集められることにワクワクする"} },
            { "type": "hand", "text": "事実を伝える時、どのような話し方をしますか？", "options": {"A": "事実だけを簡潔に伝える", "B": "相手を惹きつけるような物語や例え話を使う"} }
          ]
        },
        {
          "name_jp": "競争性",
          "name_en": "Competition",
          "domain": "Influencing",
          "keywords": ["勝利", "一番", "比較", "ライバル"],
          "questions": [
            { "type": "head", "text": "自分の成果を測る時、基準にするのは何ですか？", "options": {"A": "過去の自分や絶対的な基準", "B": "周囲のライバルや平均点との比較"} },
            { "type": "heart", "text": "ゲームや勝負事で負けた時、どう感じますか？", "options": {"A": "「楽しかったからいいや」と思う", "B": "悔しくてたまらず、次は絶対に勝ちたいと思う"} },
            { "type": "hand", "text": "仕事や作業をしている時、無意識にしていることは？", "options": {"A": "自分のペースで進める", "B": "隣の人やランキングをチラチラ見てペースを上げる"} }
          ]
        },
        {
          "name_jp": "最上志向",
          "name_en": "Maximizer",
          "domain": "Influencing",
          "keywords": ["優秀", "卓越", "強み", "質"],
          "questions": [
            { "type": "head", "text": "時間とリソースを使うなら、どちらに投資したいですか？", "options": {"A": "平均以下のものを平均レベルに引き上げる", "B": "平均以上のものを卓越したレベルに磨き上げる"} },
            { "type": "heart", "text": "「弱点を克服しよう」と言われた時、どう感じますか？", "options": {"A": "成長のために必要だと感じる", "B": "モチベーションが下がり、時間の無駄だと感じる"} },
            { "type": "hand", "text": "作業の仕上げ段階で、どう行動しますか？", "options": {"A": "合格ラインに達していれば完了する", "B": "細部までこだわって最高品質になるまで磨き続ける"} }
          ]
        },
        {
          "name_jp": "自己確信",
          "name_en": "Self-Assurance",
          "domain": "Influencing",
          "keywords": ["自信", "羅針盤", "直感", "独立"],
          "questions": [
            { "type": "head", "text": "重要な決断をする際、最終的な根拠にするのは？", "options": {"A": "専門家の意見やデータ", "B": "自分の内なる羅針盤（直感）"} },
            { "type": "heart", "text": "周囲全員が反対している道を進む時、どう感じますか？", "options": {"A": "不安で足が止まる", "B": "「自分は正しい」という揺るぎない確信がある"} },
            { "type": "hand", "text": "リスクのある挑戦をする時、どう行動しますか？", "options": {"A": "慎重に石橋を叩く", "B": "「なんとかなる」と信じて大胆に踏み出す"} }
          ]
        },
        {
          "name_jp": "自我",
          "name_en": "Significance",
          "domain": "Influencing",
          "keywords": ["重要", "認知", "影響力", "独立"],
          "questions": [
            { "type": "head", "text": "仕事のやりがいについて、どちらを重視しますか？", "options": {"A": "誰にも知られなくても、静かに貢献すること", "B": "多くの人に認められ、大きな影響を与えること"} },
            { "type": "heart", "text": "自分の貢献が無視されたり、軽く扱われた時、どう感じますか？", "options": {"A": "あまり気にしない", "B": "プライドが傷つき、強い不満を感じる"} },
            { "type": "hand", "text": "役割を選ぶ時、どちらを選びますか？", "options": {"A": "縁の下の力持ち", "B": "注目を浴びる表舞台の役割"} }
          ]
        },
        {
          "name_jp": "社交性",
          "name_en": "Woo",
          "domain": "Influencing",
          "keywords": ["出会い", "魅力", "人脈", "第一印象"],
          "questions": [
            { "type": "head", "text": "知らない人がたくさんいるパーティ会場に入った時、どう考えますか？", "options": {"A": "「知っている人はいるかな」と不安になる", "B": "「まだ見ぬ友人がたくさんいる」とワクワクする"} },
            { "type": "heart", "text": "初対面の人と会話をする時、どう感じますか？", "options": {"A": "気疲れする", "B": "エネルギーをもらえる"} },
            { "type": "hand", "text": "交流会での行動パターンはどちらに近いですか？", "options": {"A": "少数の人とじっくり話す", "B": "会場を回って、できるだけ多くの人と挨拶する"} }
          ]
        },
        // --- 3. 人間関係構築力 (Relationship Building) ---
        {
          "name_jp": "適応性",
          "name_en": "Adaptability",
          "domain": "Relationship Building",
          "keywords": ["今", "柔軟", "流れ", "即興"],
          "questions": [
            { "type": "head", "text": "将来の計画について、どう考えていますか？", "options": {"A": "数年先までしっかり計画を立てたい", "B": "未来は予測不能だから、その時々に対応すればいい"} },
            { "type": "heart", "text": "急なトラブルで予定が白紙になった時、どう感じますか？", "options": {"A": "パニックになる", "B": "「じゃあ別のことをしよう」とすぐに切り替えられる"} },
            { "type": "hand", "text": "仕事の進め方について、どちらが得意ですか？", "options": {"A": "ルーチンワークを着実にこなす", "B": "日々変化する状況に即興で対応する"} }
          ]
        },
        {
          "name_jp": "運命思考",
          "name_en": "Connectedness",
          "domain": "Relationship Building",
          "keywords": ["つながり", "縁", "全体像", "スピリチュアル"],
          "questions": [
            { "type": "head", "text": "世の中で起きる出来事について、どう考えますか？", "options": {"A": "それぞれが独立した偶然の産物だ", "B": "すべては何らかの理由があって繋がっている"} },
            { "type": "heart", "text": "チームの一体感や「ご縁」を感じた時、どう感じますか？", "options": {"A": "特になんとも思わない", "B": "深い安心感や意味を感じる"} },
            { "type": "hand", "text": "誰かを助ける時、どのような意識で行動しますか？", "options": {"A": "単なる親切心", "B": "巡り巡って自分にも返ってくるという感覚"} }
          ]
        },
        {
          "name_jp": "成長促進",
          "name_en": "Developer",
          "domain": "Relationship Building",
          "keywords": ["育成", "可能性", "進歩", "忍耐"],
          "questions": [
            { "type": "head", "text": "他人を見る時、どこに注目しますか？", "options": {"A": "現在の実力や実績", "B": "その人が秘めている将来の可能性"} },
            { "type": "heart", "text": "誰かの小さな進歩（初めてできたことなど）を見た時、どう感じますか？", "options": {"A": "「まだ未熟だな」と思う", "B": "自分のことのように大きな喜びを感じる"} },
            { "type": "hand", "text": "部下や後輩への接し方について、どちらが近いですか？", "options": {"A": "手っ取り早く答えを教える", "B": "時間がかかっても、自分で気づくのを待つ"} }
          ]
        },
        {
          "name_jp": "共感性",
          "name_en": "Empathy",
          "domain": "Relationship Building",
          "keywords": ["感情", "直感", "雰囲気", "理解"],
          "questions": [
            { "type": "head", "text": "人の悩みを理解しようとする時、どうしますか？", "options": {"A": "事実関係を整理して論理的に考える", "B": "相手の立場になりきって感情を想像する"} },
            { "type": "heart", "text": "近くに悲しんでいる人がいる時、どう感じますか？", "options": {"A": "「大変そうだな」と客観的に見る", "B": "自分まで悲しくなり、胸が痛む（感情をもらいやすい）"} },
            { "type": "hand", "text": "会話の中で、無意識にしてしまうことは？", "options": {"A": "解決策を提示する", "B": "「わかるよ」と相手の感情に寄り添う"} }
          ]
        },
        {
          "name_jp": "調和性",
          "name_en": "Harmony",
          "domain": "Relationship Building",
          "keywords": ["合意", "平和", "同意", "対立回避"],
          "questions": [
            { "type": "head", "text": "会議のゴールはなんだと考えますか？", "options": {"A": "議論を戦わせてベストな案を出すこと", "B": "全員が納得できる合意点を見つけること"} },
            { "type": "heart", "text": "誰かが声を荒らげて議論している時、どう感じますか？", "options": {"A": "活気があって良いと感じる", "B": "居心地が悪く、すぐに止めたいと感じる"} },
            { "type": "hand", "text": "意見が対立した時、どう行動しますか？", "options": {"A": "自分の正しさを主張する", "B": "相手との共通点を探し、妥協案を提示する"} }
          ]
        },
        {
          "name_jp": "包含",
          "name_en": "Includer",
          "domain": "Relationship Building",
          "keywords": ["仲間外れ", "包容", "多様性", "参加"],
          "questions": [
            { "type": "head", "text": "チームを作るとき、どう考えますか？", "options": {"A": "選抜された精鋭だけで固めたい", "B": "できるだけ多くの人に参加のチャンスを与えたい"} },
            { "type": "heart", "text": "輪に入れず一人でいる人を見た時、どう感じますか？", "options": {"A": "「一人が好きなんだろう」と思う", "B": "気になって仕方がなく、声をかけたくなる"} },
            { "type": "hand", "text": "人が増えすぎてスペースが足りない時、どうしますか？", "options": {"A": "入場を制限する", "B": "詰めて座ればなんとかなると全員を入れる"} }
          ]
        },
        {
          "name_jp": "個別化",
          "name_en": "Individualization",
          "domain": "Relationship Building",
          "keywords": ["ユニーク", "カスタマイズ", "違い", "配置"],
          "questions": [
            { "type": "head", "text": "人を評価する時、どちらに目が行きますか？", "options": {"A": "他の人との共通点や類似性", "B": "その人だけのユニークな特徴や強み"} },
            { "type": "heart", "text": "「みんなと同じ」扱いをされた時、どう感じますか？", "options": {"A": "安心する", "B": "自分を理解されていないと感じて不満だ"} },
            { "type": "hand", "text": "プレゼントを選ぶ時、どうしますか？", "options": {"A": "誰にでも喜ばれる定番を選ぶ", "B": "その人の好みに合わせて一つ一つ違うものを選ぶ"} }
          ]
        },
        {
          "name_jp": "ポジティブ",
          "name_en": "Positivity",
          "domain": "Relationship Building",
          "keywords": ["楽観", "情熱", "称賛", "ユーモア"],
          "questions": [
            { "type": "head", "text": "悪い状況に陥った時、どう考えますか？", "options": {"A": "最悪のケースを想定して備える", "B": "「なんとかなるさ」と良い面を探す"} },
            { "type": "heart", "text": "深刻で暗い雰囲気の時、どう感じますか？", "options": {"A": "真剣な場だから仕方ない", "B": "息が詰まりそうで、ジョークで空気を変えたくなる"} },
            { "type": "hand", "text": "他人への接し方について、どちらが近いですか？", "options": {"A": "問題点を指摘して改善を促す", "B": "良い点を褒めてやる気を引き出す"} }
          ]
        },
        {
          "name_jp": "親密性",
          "name_en": "Relator",
          "domain": "Relationship Building",
          "keywords": ["信頼", "深い", "友人", "透明性"],
          "questions": [
            { "type": "head", "text": "理想的な人間関係について、どう考えますか？", "options": {"A": "広く浅く、たくさんの知り合いがいること", "B": "少人数でも、何でも話せる深い関係があること"} },
            { "type": "heart", "text": "まだよく知らない人にプライベートを聞かれた時、どう感じますか？", "options": {"A": "特に気にならない", "B": "警戒心を感じ、距離を置きたくなる"} },
            { "type": "hand", "text": "忙しい時の時間の使い方として、どちらを選びますか？", "options": {"A": "交流会に行って人脈を広げる", "B": "気心の知れた友人と食事をする"} }
          ]
        },
        // --- 4. 戦略的思考力 (Strategic Thinking) ---
        {
          "name_jp": "分析思考",
          "name_en": "Analytical",
          "domain": "Strategic Thinking",
          "keywords": ["データ", "証明", "論理", "客観"],
          "questions": [
            { "type": "head", "text": "誰かの意見を聞いた時、まず考えることは？", "options": {"A": "「その感情に共感できるか」", "B": "「それは事実に基づいているか（証明できるか）」"} },
            { "type": "heart", "text": "データが整理され、論理的に完璧な説明を見た時、どう感じますか？", "options": {"A": "冷たい感じがする", "B": "美しさと心地よさを感じる"} },
            { "type": "hand", "text": "何かを主張する時、どう行動しますか？", "options": {"A": "情熱やストーリーで訴える", "B": "客観的なデータや証拠を提示する"} }
          ]
        },
        {
          "name_jp": "原点思考",
          "name_en": "Context",
          "domain": "Strategic Thinking",
          "keywords": ["過去", "歴史", "背景", "経緯"],
          "questions": [
            { "type": "head", "text": "未来の計画を立てる時、何が必要だと考えますか？", "options": {"A": "斬新なアイデアとビジョン", "B": "過去の成功例や経緯の理解"} },
            { "type": "heart", "text": "歴史小説やドキュメンタリー、昔話を聞く時、どう感じますか？", "options": {"A": "退屈に感じる", "B": "学びがあり、面白いと感じる"} },
            { "type": "hand", "text": "新しい環境に入った時、まず何をしますか？", "options": {"A": "これからの目標を立てる", "B": "それがどうやって成立したか、背景を調べる"} }
          ]
        },
        {
          "name_jp": "未来志向",
          "name_en": "Futuristic",
          "domain": "Strategic Thinking",
          "keywords": ["ビジョン", "夢", "明日", "可能性"],
          "questions": [
            { "type": "head", "text": "あなたの思考はどの時間軸にありますか？", "options": {"A": "「今、目の前のこと」や「過去」", "B": "「数年後、数十年後の未来」"} },
            { "type": "heart", "text": "未来のビジョンを語っている時、どう感じますか？", "options": {"A": "現実味がなくて不安になる", "B": "エネルギーが湧いてきてワクワクする"} },
            { "type": "hand", "text": "壁にぶつかった時、どうやって乗り越えますか？", "options": {"A": "現実的な対処法を探す", "B": "成功した未来の姿を具体的にイメージする"} }
          ]
        },
        {
          "name_jp": "着想",
          "name_en": "Ideation",
          "domain": "Strategic Thinking",
          "keywords": ["アイデア", "創造", "つながり", "新規性"],
          "questions": [
            { "type": "head", "text": "問題解決のアプローチとして、どちらを好みますか？", "options": {"A": "実績のある確実な方法をとる", "B": "今まで誰もやらなかった新しい方法を考える"} },
            { "type": "heart", "text": "ブレインストーミングでアイデアを出し合う時、どう感じますか？", "options": {"A": "疲れる", "B": "最高に楽しい"} },
            { "type": "hand", "text": "一見関係ない物事の間に「つながり」を見つけることがよくありますか？", "options": {"A": "あまりない", "B": "よくあり、それを面白がる"} }
          ]
        },
        {
          "name_jp": "収集心",
          "name_en": "Input",
          "domain": "Strategic Thinking",
          "keywords": ["情報", "収集", "知的好奇心", "アーカイブ"],
          "questions": [
            { "type": "head", "text": "知らない言葉や情報に出会った時、どう考えますか？", "options": {"A": "今の自分に関係なければスルーする", "B": "「知っておきたい」と反射的に調べる"} },
            { "type": "heart", "text": "インターネットで情報を検索している時、どう感じますか？", "options": {"A": "必要な情報が見つかったらすぐ終わりたい", "B": "リンクを辿って知識が増えることに快感を覚える"} },
            { "type": "hand", "text": "本や記事、ファイルなどをどう扱いますか？", "options": {"A": "読んだら捨てるか、整理して減らす", "B": "「いつか役に立つかも」と保存・蓄積する"} }
          ]
        },
        {
          "name_jp": "内省",
          "name_en": "Intellection",
          "domain": "Strategic Thinking",
          "keywords": ["思考", "哲学", "独り", "深さ"],
          "questions": [
            { "type": "head", "text": "「考えること」自体をどう捉えていますか？", "options": {"A": "行動するための準備", "B": "それ自体が目的であり、喜び"} },
            { "type": "heart", "text": "一人で静かに過ごす時間が取れないと、どう感じますか？", "options": {"A": "寂しい", "B": "精神的に消耗し、イライラする"} },
            { "type": "hand", "text": "深く考えるような哲学的・知的な議論になった時、どうしますか？", "options": {"A": "難しそうなので避ける", "B": "喜んで参加し、思考を深める"} }
          ]
        },
        {
          "name_jp": "学習欲",
          "name_en": "Learner",
          "domain": "Strategic Thinking",
          "keywords": ["学ぶ", "プロセス", "向上", "好奇心"],
          "questions": [
            { "type": "head", "text": "新しいスキルを習得する時、何が重要ですか？", "options": {"A": "そのスキルを使って結果を出すこと", "B": "ゼロから学んでできるようになるプロセスそのもの"} },
            { "type": "heart", "text": "知らない分野の話を聞く時、どう感じますか？", "options": {"A": "興味がない", "B": "好奇心が刺激され、ワクワクする"} },
            { "type": "hand", "text": "現状維持よりも、常に新しいことを学び続けたいと思いますか？", "options": {"A": "今のスキルで十分ならそれでいい", "B": "常に何かを学んでいないと落ち着かない"} }
          ]
        },
        {
          "name_jp": "戦略性",
          "name_en": "Strategic",
          "domain": "Strategic Thinking",
          "keywords": ["選択肢", "パターン", "直感", "予測"],
          "questions": [
            { "type": "head", "text": "複雑な状況において、あなたの思考はどう働きますか？", "options": {"A": "一つずつ詳細を確認する", "B": "俯瞰してパターンを読み取り、ゴールまでの道筋を描く"} },
            { "type": "heart", "text": "「プランB（代替案）」を考えている時、どう感じますか？", "options": {"A": "面倒だし、プランAが失敗するようで嫌だ", "B": "あらゆる可能性を想定できて安心する"} },
            { "type": "hand", "text": "行き詰まった時、どう行動しますか？", "options": {"A": "諦めずに同じ方法で粘る", "B": "即座に別のルート（攻略法）を見つけ出して試す"} }
          ]
        }
      ]
    };
    // ▲▲▲ データここまで ▲▲▲

    let allQuestions = [];
    let currentQuestionIndex = 0;
    let scores = {}; 
    let startTime;
    let historyStack = [];

    const startScreen = document.getElementById('start-screen');
    const quizScreen = document.getElementById('quiz-screen');
    const resultScreen = document.getElementById('result-screen');
    const btnBack = document.getElementById('btn-back');
    
    function prepareQuestions() {
        allQuestions = [];
        scores = {};
        historyStack = [];
        
        diagnosisData.themes.forEach(theme => {
            scores[theme.name_jp] = 0;
            if(theme.questions && Array.isArray(theme.questions)) {
                theme.questions.forEach(q => {
                    allQuestions.push({
                        theme: theme.name_jp,
                        name_en: theme.name_en,
                        domain: theme.domain,
                        keywords: theme.keywords,
                        type: q.type,
                        text: q.text,
                        options: q.options
                    });
                });
            }
        });
        shuffle(allQuestions);
    }

    function shuffle(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
    }

    function startQuiz() {
        if (!diagnosisData.themes || diagnosisData.themes.length === 0) {
            alert("データがありません。JSONデータをコード内に貼り付けてください。");
            return;
        }

        prepareQuestions();
        currentQuestionIndex = 0;
        startScreen.classList.add('hidden');
        quizScreen.classList.remove('hidden');
        renderQuestion();
    }

    function renderQuestion() {
        if (currentQuestionIndex >= allQuestions.length) {
            showResult();
            return;
        }

        const q = allQuestions[currentQuestionIndex];
        
        if (currentQuestionIndex > 0) {
            btnBack.classList.remove('hidden');
        } else {
            btnBack.classList.add('hidden');
        }

        document.getElementById('q-type').textContent = q.type.toUpperCase();
        document.getElementById('question-text').textContent = q.text;
        document.getElementById('text-a').textContent = q.options.A;
        document.getElementById('text-b').textContent = q.options.B;

        const progress = ((currentQuestionIndex) / allQuestions.length) * 100;
        document.getElementById('progress-bar').style.width = `${progress}%`;
        document.getElementById('progress-text').textContent = `${currentQuestionIndex + 1} / ${allQuestions.length}`;
        
        startTime = Date.now();
        window.scrollTo(0, 0);
    }

    function handleAnswer(scaleValue) {
        const endTime = Date.now();
        const responseTime = endTime - startTime;
        const q = allQuestions[currentQuestionIndex];

        let points = 0;
        switch(scaleValue) {
            case 1: points = 0; break;
            case 2: points = 1; break;
            case 3: points = 2; break;
            case 4: points = 3; break;
            case 5: points = 4; break;
        }

        if ((scaleValue === 4 || scaleValue === 5) && responseTime < 2500) {
            points += 0.5;
        }

        scores[q.theme] += points;

        historyStack.push({
            theme: q.theme,
            points: points
        });
        
        currentQuestionIndex++;
        setTimeout(renderQuestion, 150);
    }

    function goBack() {
        if (currentQuestionIndex === 0 || historyStack.length === 0) return;

        currentQuestionIndex--;
        const lastAction = historyStack.pop();

        if (lastAction) {
            scores[lastAction.theme] -= lastAction.points;
        }

        renderQuestion();
    }

    function showResult() {
        quizScreen.classList.add('hidden');
        resultScreen.classList.remove('hidden');
        btnBack.classList.add('hidden');

        const sortedScores = Object.entries(scores).sort((a, b) => b[1] - a[1]);
        const top5 = sortedScores.slice(0, 5);
        const resultList = document.getElementById('result-list');
        resultList.innerHTML = '';

        top5.forEach((item, index) => {
            const themeName = item[0];
            const themeInfo = diagnosisData.themes.find(t => t.name_jp === themeName);
            
            let domainClass = "";
            if(themeInfo.domain.includes("Executing")) domainClass = "domain-Executing";
            else if(themeInfo.domain.includes("Influencing")) domainClass = "domain-Influencing";
            else if(themeInfo.domain.includes("Relationship")) domainClass = "domain-Relationship";
            else if(themeInfo.domain.includes("Strategic")) domainClass = "domain-Strategic";

            const div = document.createElement('div');
            div.className = 'result-card';
            div.innerHTML = `
                <div style="display:flex; justify-content:space-between; align-items:center;">
                    <span style="font-weight:bold; color:#888;">RANK ${index + 1}</span>
                    <span class="domain-badge ${domainClass}">${themeInfo.domain}</span>
                </div>
                <h3>${themeName} <small>(${themeInfo.name_en})</small></h3>
                <p>特徴: ${themeInfo.keywords.join(' / ')}</p>
            `;
            resultList.appendChild(div);
        });
    }
</script>

</body>
</html>